<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Grunt-livereload-demo by helicese</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Grunt-livereload-demo</h1>
      <h2 class="project-tagline">a simple demo using grunt to enable livereload and jshint in the front-end</h2>
      <a href="https://github.com/helicese/grunt-livereload-demo" class="btn">View on GitHub</a>
      <a href="https://github.com/helicese/grunt-livereload-demo/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/helicese/grunt-livereload-demo/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="grunt-livereload-demo" class="anchor" href="#grunt-livereload-demo" aria-hidden="true"><span class="octicon octicon-link"></span></a>grunt-livereload-demo</h1>

<p>a simple demo using grunt to enable livereload and jshint in the front-end</p>

<h3>
<a id="plugins" class="anchor" href="#plugins" aria-hidden="true"><span class="octicon octicon-link"></span></a>plugins</h3>

<ul>
<li>
<a href="https://github.com/gruntjs/grunt-contrib-connect">grunt-contrib-connect</a>
: establish a server to watch the changes</li>
<li>
<a href="https://github.com/gruntjs/grunt-contrib-watch">grunt-contrib-watch</a>
: watch the changes and do tasks on changing</li>
<li>
<a href="https://github.com/gruntjs/grunt-contrib-jshint">grunt-contrib-jshint</a>
: check the js files and detect the errors</li>
<li>
<a href="https://github.com/gruntjs/grunt-contrib-uglify">grunt-contrib-uglify</a>
: compress the js files</li>
<li>
<a href="https://github.com/gruntjs/grunt-contrib-cssmin">grunt-contrib-cssmin</a>
: compress the css files</li>
<li>
<a href="https://github.com/sindresorhus/load-grunt-tasks">load-grunt-tasks</a>
: one line(<code>require('load-grunt-tasks')(grunt);</code>)the load all the tasks</li>
</ul>

<h3>
<a id="instructions" class="anchor" href="#instructions" aria-hidden="true"><span class="octicon octicon-link"></span></a>instructions</h3>

<p>first get the code and install the plugins:</p>

<pre><code>  git clone https://github.com/helicese/grunt-livereload-demo
  cd grunt-livereload-demo
  npm install
</code></pre>

<p>then:</p>

<ul>
<li>
<code>grunt</code>: to start the server and run the watch task</li>
<li>
<code>grunt cssmin</code>: compress the css file</li>
<li>
<code>grunt uglify</code>: compress the js file</li>
</ul>

<h3>
<a id="tips" class="anchor" href="#tips" aria-hidden="true"><span class="octicon octicon-link"></span></a>tips</h3>

<blockquote>
<p>This details really cost me a lot of time</p>
</blockquote>

<ul>
<li>Do not registe Task for the loaded plugins, which will make it unusable</li>
<li>in the path, there is no '/' at the beginning.</li>
<li>to enable livereload, a <a href="https://chrome.google.com/webstore/detail/livereload/jnihajbhpnppcggbcgedagnkighmdlei">livereload plugin</a> of the browser is needed and make sure it is switched on(the center circle of the icon be filled).</li>
</ul>

<h3>
<a id="references" class="anchor" href="#references" aria-hidden="true"><span class="octicon octicon-link"></span></a>references:</h3>

<p><a href="http://www.gruntjs.net/">http://www.gruntjs.net/</a></p>

<p><a href="http://bellyang.com/blog/post-606.html">http://bellyang.com/blog/post-606.html</a></p>

<hr>

<h1>
<a id="grunt使用心得" class="anchor" href="#grunt%E4%BD%BF%E7%94%A8%E5%BF%83%E5%BE%97" aria-hidden="true"><span class="octicon octicon-link"></span></a>grunt使用心得</h1>

<h2>
<a id="reference" class="anchor" href="#reference" aria-hidden="true"><span class="octicon octicon-link"></span></a>Reference</h2>

<ul>
<li>
<a href="http://www.cnblogs.com/tarol/category/643890.html">grunt系列博客</a>： 非常详细～</li>
<li><a href="http://www.cnblogs.com/tarol/p/4242360.html">grunt之connect,watch</a></li>
<li><a href="http://www.cnblogs.com/tarol/p/4253787.html">grunt之watch续</a></li>
</ul>

<h2>
<a id="files" class="anchor" href="#files" aria-hidden="true"><span class="octicon octicon-link"></span></a>files：</h2>

<ul>
<li>三种格式：</li>
</ul>

<pre><code>//第一种，文件数组格式，满足所有要求；
//对应多个src-dest文件映射，也可添加额外的属性值
files: [
        {src: ['src/bb.js', 'src/bbb.js'], dest: 'dest/b/', nonull: true},
        {src: ['src/bb1.js', 'src/bbb1.js'], dest: 'dest/b1/', filter: 'isFile'},
      ],

//第二种，文件对象格式，无法设置其他参数
//属性名就是目标文件，源文件就是它的值(源文件列表则使用数组格式声明)
files : {
    'dest/hello.js' ： ['src/*.js']
}

//第三种，简洁格式，只能设置单个任务，可添加额外属性，
//连file属性名都不用写，直接dest和src
dest : 'dest/hello.js',
src : ['src/*.js']
</code></pre>

<ul>
<li>通配符：

<ul>
<li>*：匹配任意数量的字符，不包括/。</li>
<li>?：匹配单个字符，不包括/。</li>
<li>**：匹配任意数量的字符，包括/。</li>
<li>{}：允许使用逗号分隔的列表，表示“or”（或）关系。</li>
<li>!：用于模式的开头，表示只返回不匹配的情况。</li>
</ul>
</li>
<li>动态构建文件对象：</li>
</ul>

<pre><code>    files: [
        {
          expand: true,     // Enable dynamic expansion.
          cwd: 'lib/',      // Src matches are relative to this path.
          src: ['**/*.js'], // Actual pattern(s) to match.
          dest: 'build/',   // Destination path prefix.
          ext: '.min.js',   // Dest filepaths will have this extension.
          extDot: 'first'   // Extensions in filenames begin after the first dot
        },
      ], 
</code></pre>

<h2>
<a id="grunt-contrib-connect" class="anchor" href="#grunt-contrib-connect" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/gruntjs/grunt-contrib-connect">grunt-contrib-connect</a>
</h2>

<blockquote>
<p>Run this task with the <code>grunt connect</code> command.</p>

<p>Note that this server only runs as long as grunt is running. Once grunt's tasks have completed, the web server stops. This behavior can be changed with the <em>keepalive</em> option, and can be enabled ad-hoc by running the task like <code>grunt connect:keepalive</code>.</p>

<p>This task was designed to be used in conjunction with another task that is run immediately afterwards, like the <em>grunt-contrib-qunit plugin</em> <code>qunit</code> task.</p>
</blockquote>

<ul>
<li>功能：搭建一个本地connect服务器，使得livereload时并不需要借用其他工具来搭建服务器；</li>
<li>opinions:

<ul>
<li>hostname: 默认'0.0.0.0',只要能和本机ping通都能访问,设定为'localhost'则只有本机能够访问</li>
<li>base: 静态服务器文件根目录,支持String, Array, Object;</li>
<li>keepalive: 默认为false,结果是运行结果服务器开启之后瞬间就关闭了(用于测试),将此opinion设置为true能让服务器一直运行下去,要注意keepalive会阻塞接下来的grunt任务,要谨慎使用;</li>
<li>livereload: 依赖于浏览器的livereload插件,只有和watch配合使用才有效果</li>
</ul>
</li>
<li>Tips：

<ul>
<li>根目录中有index.html时,访问服务器会直接链接到index.html,若没有index.html,则看到的是根目录下的目录结构(connect做得比较细腻的部分)</li>
<li>base的value为数组时,数组内为多个目录,若都有index.html,则文件索引为前面的文件夹优先级更高,若没index.html则文件夹索引为后面的文件夹优先级更高</li>
<li>实现livereload时,keepalive应设置为false,由于watch的存在,grunt会一直处于执行状态,所以服务器不会终止,而keepalive若为true,则connect会一直阻塞,watch不会执行,livereload失败.
我的配置：</li>
</ul>
</li>
</ul>

<pre><code>    connect: {
      options: {
        open: true,//let the browser run automatically
        port: 8000,
        hostname: 'localhost',//only this machine can access to the server
        livereload: 35729//the port for the watch task
      },
      server: {
        options: {
          //base define the root directory of the server, default to be the root where Gruntfile.js exists.
          base: [
            'views' //the base path
          ]
        }
      }
    },
</code></pre>

<h2>
<a id="grunt-contrib-watch" class="anchor" href="#grunt-contrib-watch" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/gruntjs/grunt-contrib-watch">grunt-contrib-watch</a>
</h2>

<ul>
<li>功能： 监控文件变化，做出相关反应；</li>
<li>
<p>opinions：</p>

<ul>
<li>spawn: 链接里讲的很详细，不过我觉得没什么必要，直接设置成false就好；
&gt; 如果你的Gruntfile.js中读取了输入命令的部分值并保存为变量，请将此option设置为false，不然watch启动的task中将读取不到这些变量。</li>
</ul>
</li>
<li><p>我的配置：</p></li>
</ul>

<pre><code>    watch:{
      javascript: {
        files: ['views/js/*.js', 'views/css/*.css','views/main.html'],
        tasks: ['jshint'],
        options: {
          spawn: false,//speed up the watch task
          livereload: '&lt;%= connect.options.livereload %&gt;'
        },
      },
      gruntfile: {
        files: 'Gruntfile.js',
        tasks: ['jshint'],
        options: {
          reload: true,
          spawn: false
        },
      }
    },
</code></pre>

<ul>
<li>说明：这个plugin有两个task，javascript负责监控js文件变化并调用jshint工具来检测语法，gruntfile负责监测Gruntfile.js的变化，在变化后重启grunt任务。</li>
</ul>

<h2>
<a id="grunt-contrib-jshint" class="anchor" href="#grunt-contrib-jshint" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/gruntjs/grunt-contrib-jshint">grunt-contrib-jshint</a>
</h2>

<p>功能： 检测javascript语法～
这个插件算是jshint工具的一个分支吧，很多内容可以参考<a href="http://jshint.com/">jsHint</a>官网,<a href="https://github.com/jshint/jshint/blob/master/examples/.jshintrc">这里</a>包含了常用的配置清单，可以根据这里的内容来配置出属于自己的jshint。
我的配置：</p>

<pre><code>jshint:{
  opinions:{
    eqeqeq: true, //要用严格相等运算符取代相等运算符
    trailing: true, //行尾不得有多余的空格
  },
  src: ['views/js/*.js','*.js']
}
</code></pre>

<h2>
<a id="grunt-contrib-cssmin" class="anchor" href="#grunt-contrib-cssmin" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/gruntjs/grunt-contrib-cssmin">grunt-contrib-cssmin</a>
</h2>

<p>功能：压缩，合并css代码
我的配置：</p>

<pre><code>cssmin:{
    minify: {
        expand: true,
        cwd: 'views/css/',
        src: ['*.css', '!*.min.css'],
        dest: 'views/dest/css/',
        ext: '.min.css'
    },
}
</code></pre>

<h2>
<a id="grunt-contrib-uglify" class="anchor" href="#grunt-contrib-uglify" aria-hidden="true"><span class="octicon octicon-link"></span></a><a href="https://github.com/gruntjs/grunt-contrib-uglify">grunt-contrib-uglify</a>
</h2>

<p>功能：压缩javascript文件
我的配置：</p>

<pre><code>uglify: {
  options: {
     banner: '/*! &lt;%= pkg.name %&gt; &lt;%= grunt.template.today("yyyy-mm-dd") %&gt; */\n'
  },
  build: {
    expand: true,
    cwd: 'views/js',
    src: ['*.js', '!*.min.js'],
    dest: 'views/dest/js',
    ext: '.min.js'
  }
},
</code></pre>

<hr>

<ul>
<li>李辉<br>
</li>
<li><a href="mailto:helicese@gmail.com">helicese@gmail.com</a></li>
<li>热爱学习的前端小兵,欢迎交流讨论</li>
<li>2015.8.7</li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/helicese/grunt-livereload-demo">Grunt-livereload-demo</a> is maintained by <a href="https://github.com/helicese">helicese</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
